var P=Object.defineProperty,Y=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var C=(e,t,n)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))F.call(t,n)&&C(e,n,t[n]);if(w)for(var n of w(t))E.call(t,n)&&C(e,n,t[n]);return e},R=(e,t)=>Y(e,A(t));import{g as T,j as x,b as W,r as z,o as h,h as k,w as K,k as i,t as f,u as r,p as q,q as j,v as J,i as G,K as H,D as Q,a2 as U,L as V,l as $,C as N,F as X,n as Z,J as B,y as ee,aa as te}from"./vendor.ce23a725.js";import{_ as D,u as L,a as se,b as ne,c as ae}from"./index.bc6b037d.js";const M=e=>(j("data-v-779aae1a"),e=e(),J(),e),re={class:"search-result"},oe={class:"search-result-header"},ce=M(()=>i("span",{class:"em"},"\u2014",-1)),ue={class:"search-result-date"},ie=M(()=>i("span",{class:"hover-msg"},"View in channel",-1)),le=T({props:{message:null},setup(e){const t=e,n=L(),o=x(()=>n.channels.find(a=>a.id===t.message.channelId)),c=x(()=>W(t.message.ts).format("MMM Do, YYYY"));return(a,d)=>{const s=se,m=z("router-link");return h(),k(m,{to:`/channel/${r(o).id}?threadRef=${r(o).id}-${e.message.id}`,class:"search-result-link"},{default:K(()=>[i("div",re,[i("div",oe,[i("strong",null,"# "+f(r(o).name),1),ce,i("span",ue,f(r(c)),1),ie]),q(s,{message:e.message,"channel-id":r(o).id,"above-message":null,"file-max-height":75,"name-date-format":"h:mm a","hide-date-rule":"","small-replies":""},null,8,["message","channel-id"])])]),_:1},8,["to"])}}});var de=D(le,[["__scopeId","data-v-779aae1a"]]),_e=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=void 0,a=void 0,d=void 0,s=[];return function(){var y=he(n),u=new Date().getTime(),l=!c||u-c>y;c=u;for(var _=arguments.length,g=Array(_),p=0;p<_;p++)g[p]=arguments[p];if(l&&o.leading)return o.accumulate?Promise.resolve(t.call(this,[g])).then(function(S){return S[0]}):Promise.resolve(t.call.apply(t,[this].concat(g)));if(a?clearTimeout(d):a=me(),s.push(g),d=setTimeout(m.bind(this),y),o.accumulate){var b=s.length-1;return a.promise.then(function(S){return S[b]})}return a.promise};function m(){var v=a;clearTimeout(d),Promise.resolve(o.accumulate?t.call(this,s):t.apply(this,s[s.length-1])).then(v.resolve,v.reject),s=[],a=null}};function he(e){return typeof e=="function"?e():e}function me(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e}const O=e=>(j("data-v-dd4b183e"),e=e(),J(),e),pe={class:"results-list"},ve=O(()=>i("div",{id:"search-top"},null,-1)),ge={key:0},fe=ee(" Results "),ye={key:1,class:"no-results"},be=O(()=>i("p",null,"No results found.",-1)),Se=[be],$e={key:2,class:"pagination"},xe={class:"pagination-page"},ke=T({setup(e){const t=G(),n=H(),o=L(),c=Q([]),a=50,d=x(()=>!o.dataLoaded||t.name!=="search"?null:t.query.query&&JSON.parse(`${t.query.query}`)||null),s=x(()=>!o.dataLoaded||t.name!=="search"?0:Number(t.query.page||0)),m=u=>{n.push({path:"/search",query:R(I({},t.query),{page:u||void 0})})},v=async()=>{if(!d.value)return;const u=await o.searchMessages(d.value,a,a*s.value);c.value=u},y=_e(()=>v(),100);return U(()=>{if(!t.query.query){n.push("/");return}v()}),V(d,(u,l)=>{u&&JSON.stringify(u)!==JSON.stringify(l)&&(l&&m(0),y(),!l&&JSON.stringify(u)!==JSON.stringify(o.activeSearch.content[0].content)&&(o.activeSearch.content[0].content=u))}),V(s,async(u,l)=>{u!==l&&(await y(),te(()=>{const _=document.getElementById("search-top");_==null||_.scrollIntoView()}))}),(u,l)=>{const _=ne,g=de,p=ae;return h(),$("div",pe,[ve,i("h1",null,[r(d)?(h(),k(_,{key:0,content:r(d),prefix:"Search Results For: ",large:""},null,8,["content"])):N("",!0)]),r(s)>0?(h(),$("p",ge,[fe,i("span",null,f(r(s)*a+1)+" \u2014 "+f(r(s)*a+c.value.length),1)])):N("",!0),(h(!0),$(X,null,Z(c.value,(b,S)=>(h(),k(g,{key:S,message:b},null,8,["message"]))),128)),c.value.length===0?(h(),$("div",ye,Se)):r(s)!==0||c.value.length===a?(h(),$("div",$e,[i("button",{class:B(["btn btn-icon",{disabled:r(s)<1}]),onClick:l[0]||(l[0]=b=>r(s)>0&&m(r(s)-1))},[q(p,{icon:"mdi:chevron-left-circle-outline"})],2),i("span",xe,f(r(s)*a+1)+" \u2014 "+f(r(s)*a+c.value.length),1),i("button",{class:B(["btn btn-icon",{disabled:c.value.length<a}]),onClick:l[1]||(l[1]=b=>c.value.length===a&&m(r(s)+1))},[q(p,{icon:"mdi:chevron-right-circle-outline"})],2)])):N("",!0)])}}});var Ce=D(ke,[["__scopeId","data-v-dd4b183e"]]);export{Ce as default};
